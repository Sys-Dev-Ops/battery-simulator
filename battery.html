<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Battery Status (SVG)</title>
  <style>
    body {
      font-family: sans-serif;
      text-align: center;
      margin-top: 50px;
    }
    svg {
      width: 200px;
      height: auto;
    }
    #percentageText {
      font-size: 24px;
      margin-top: 10px;
    }
  </style>
</head>
<body>

  <!-- SVG Battery Graphic -->
  <svg viewBox="0 0 120 60" xmlns="http://www.w3.org/2000/svg">
    <!-- Battery Outline -->
    <rect x="2" y="10" width="100" height="40" rx="5" ry="5" fill="none" stroke="#333" stroke-width="4"/>
    <!-- Battery Tip -->
    <rect x="104" y="22" width="12" height="16" rx="2" ry="2" fill="#333"/>
    <!-- Battery Fill -->
    <rect id="batteryFill" x="4" y="12" width="96" height="36" rx="3" ry="3" fill="green"/>
  </svg>

  <!-- Percentage Text -->
  <div id="percentageText">Loading...</div>

  <script>
    function updateBattery() {
      fetch('battery.txt')
        .then(response => response.text())
        .then(percent => {
          const percentage = parseInt(percent.trim(), 10);
          const safePercentage = Math.max(0, Math.min(100, percentage));

          const fillWidth = (safePercentage / 100) * 96; // full width is 96
          const batteryFill = document.getElementById('batteryFill');
          const percentageText = document.getElementById('percentageText');

          batteryFill.setAttribute('width', fillWidth);
          batteryFill.setAttribute('fill', safePercentage <= 20 ? 'red' : (safePercentage <= 50 ? 'orange' : 'green'));
          percentageText.textContent = safePercentage + '%';
        })
        .catch(error => {
          console.error("Error reading battery:", error);
        });
    }

    setInterval(updateBattery, 5000); // every 5 seconds
    updateBattery(); // initial load
  </script>

</body>
</html>
